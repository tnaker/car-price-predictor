<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI ƒê·ªãnh Gi√° Xe</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    
    <style>
        /* GI·ªÆ NGUY√äN CSS ƒê·∫∏P C≈® */
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        .container {
            background-color: white;
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 15px 30px rgba(0,0,0,0.2);
            width: 100%;
            max-width: 800px; /* M·ªü r·ªông chi·ªÅu ngang ƒë·ªÉ ch·ª©a nhi·ªÅu c·ªôt */
        }
        h2 { color: #333; margin-bottom: 10px; font-weight: 600; text-align: center; }
        
        /* Chia c·ªôt l∆∞·ªõi (Grid) ƒë·ªÉ form g·ªçn h∆°n */
        .grid-container {
            display: grid;
            grid-template-columns: 1fr 1fr; /* 2 c·ªôt */
            gap: 15px;
        }

        .form-group { margin-bottom: 5px; }
        label { display: block; margin-bottom: 5px; color: #555; font-size: 13px; font-weight: 600; }
        input, select {
            width: 100%; padding: 10px; border: 2px solid #eee;
            border-radius: 8px; font-size: 14px; font-family: 'Poppins', sans-serif;
        }
        input:focus, select:focus { border-color: #764ba2; outline: none; }

        button {
            width: 100%; padding: 15px; margin-top: 20px;
            background: linear-gradient(to right, #667eea, #764ba2);
            color: white; border: none; border-radius: 50px;
            font-size: 16px; font-weight: 600; cursor: pointer;
            transition: transform 0.2s;
        }
        button:hover { transform: scale(1.02); }

        #result {
            margin-top: 25px; padding: 20px; background-color: #f0f4f8;
            border-radius: 15px; border-left: 5px solid #764ba2;
            text-align: center; display: none;
        }
        .price-tag { font-size: 32px; color: #2d3748; font-weight: bold; }
        
        .section-title {
            grid-column: 1 / -1; /* Ti√™u ƒë·ªÅ chi·∫øm h·∫øt chi·ªÅu ngang */
            font-size: 14px; color: #764ba2; margin-top: 10px;
            border-bottom: 1px solid #eee; padding-bottom: 5px;
        }
    </style>
</head>
<body>

    <div class="container">
        <h2>üöó WEB ƒê·ªäNH GI√Å XE H∆†I</h2>
        <p style="text-align: center; color: #666; margin-bottom: 20px; font-size: 14px;">Nh·∫≠p ƒë·∫ßy ƒë·ªß th√¥ng s·ªë k·ªπ thu·∫≠t</p>

        <form id="carForm" onsubmit="return false;">
            <div class="grid-container">
                
                <div class="section-title">1. Th√¥ng tin chung</div>
                <div class="form-group">
                    <label>H√£ng xe (Make)</label>
                    <input type="text" id="Make" value="BMW" placeholder="VD: BMW, Toyota...">
                </div>
                <div class="form-group">
                    <label>NƒÉm s·∫£n xu·∫•t (Year)</label>
                    <input type="number" id="Year" value="2011">
                </div>
                <div class="form-group">
                    <label>ƒê·ªô ph·ªï bi·∫øn (Popularity)</label>
                    <input type="number" id="Popularity" value="3916" placeholder="VD: 1000 - 5000">
                </div>

                <div class="section-title">2. ƒê·ªông c∆° & Nhi√™n li·ªáu</div>
                <div class="form-group">
                    <label>M√£ l·ª±c (Engine HP)</label>
                    <input type="number" id="Engine_HP" value="300">
                </div>
                <div class="form-group">
                    <label>S·ªë Xi-lanh (Cylinders)</label>
                    <input type="number" id="Engine_Cylinders" value="6">
                </div>
                <div class="form-group">
                    <label>Lo·∫°i nhi√™n li·ªáu</label>
                    <select id="Engine_Fuel_Type">
                        <option value="premium unleaded (required)" selected>Premium Unleaded (Required)</option>
                        <option value="regular unleaded">Regular Unleaded</option>
                        <option value="premium unleaded (recommended)">Premium Unleaded (Recommended)</option>
                        <option value="flex-fuel (unleaded/E85)">Flex-fuel (E85)</option>
                        <option value="diesel">Diesel</option>
                    </select>
                </div>

                <div class="section-title">3. H·ªôp s·ªë & D·∫´n ƒë·ªông</div>
                <div class="form-group">
                    <label>H·ªôp s·ªë (Transmission)</label>
                    <select id="Transmission_Type">
                        <option value="MANUAL" selected>S·ªë s√†n (MANUAL)</option>
                        <option value="AUTOMATIC">T·ª± ƒë·ªông (AUTOMATIC)</option>
                        <option value="AUTOMATED_MANUAL">T·ª± ƒë·ªông h√≥a (AUTOMATED_MANUAL)</option>
                        <option value="DIRECT_DRIVE">Tr·ª±c ti·∫øp (DIRECT_DRIVE)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>D·∫´n ƒë·ªông (Driven Wheels)</label>
                    <select id="Driven_Wheels">
                        <option value="rear wheel drive" selected>C·∫ßu sau (RWD)</option>
                        <option value="front wheel drive">C·∫ßu tr∆∞·ªõc (FWD)</option>
                        <option value="all wheel drive">4 b√°nh (AWD)</option>
                        <option value="four wheel drive">4 b√°nh (4WD)</option>
                    </select>
                </div>

                <div class="section-title">4. Ki·ªÉu d√°ng & Ti√™u th·ª•</div>
                <div class="form-group">
                    <label>K√≠ch th∆∞·ªõc xe</label>
                    <select id="Vehicle_Size">
                        <option value="Compact" selected>Nh·ªè (Compact)</option>
                        <option value="Midsize">V·ª´a (Midsize)</option>
                        <option value="Large">L·ªõn (Large)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Ki·ªÉu d√°ng xe</label>
                    <select id="Vehicle_Style">
                        <option value="Coupe" selected>Coupe (2 c·ª≠a)</option>
                        <option value="Sedan">Sedan (4 c·ª≠a)</option>
                        <option value="SUV">SUV</option>
                        <option value="Hatchback">Hatchback</option>
                        <option value="Convertible">Mui tr·∫ßn</option>
                        <option value="Pickup">B√°n t·∫£i</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>MPG Cao t·ªëc</label>
                    <input type="number" id="highway_MPG" value="28">
                </div>
                <div class="form-group">
                    <label>MPG Trong ph·ªë</label>
                    <input type="number" id="city_mpg" value="19">
                </div>

            </div> <button onclick="duDoanGiaXe()" id="btnPredict">üîÆ ƒê·ªäNH GI√Å NGAY</button>
        </form>

        <div id="result">
            <div style="font-size: 14px; text-transform: uppercase; color: #a0aec0;">Gi√° tr·ªã ∆∞·ªõc t√≠nh</div>
            <div class="price-tag" id="priceDisplay">...</div>
            <div id="msgDisplay">...</div>
        </div>
    </div>

    <script>
        async function duDoanGiaXe() {
            const btn = document.getElementById("btnPredict");
            const resultBox = document.getElementById("result");
            
            // Hi·ªáu ·ª©ng n√∫t b·∫•m
            btn.innerText = "‚è≥ ƒêang ph√¢n t√≠ch...";
            btn.disabled = true;
            resultBox.style.display = "none";

            // L·∫•y to√†n b·ªô d·ªØ li·ªáu t·ª´ form
            const data = {
                "Make": document.getElementById("Make").value,
                "Year": parseInt(document.getElementById("Year").value),
                "Engine_HP": parseFloat(document.getElementById("Engine_HP").value),
                "Engine_Cylinders": parseFloat(document.getElementById("Engine_Cylinders").value),
                "highway_MPG": parseInt(document.getElementById("highway_MPG").value),
                "city_mpg": parseInt(document.getElementById("city_mpg").value),
                "Popularity": parseInt(document.getElementById("Popularity").value),
                
                // C√°c gi√° tr·ªã l·∫•y t·ª´ Dropdown (Select)
                "Transmission_Type": document.getElementById("Transmission_Type").value,
                "Driven_Wheels": document.getElementById("Driven_Wheels").value,
                "Vehicle_Size": document.getElementById("Vehicle_Size").value,
                "Vehicle_Style": document.getElementById("Vehicle_Style").value,
                "Engine_Fuel_Type": document.getElementById("Engine_Fuel_Type").value
            };

            try {
                // G·ªçi API
                const response = await fetch("/predict_price/", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify(data)
                });

                const result = await response.json();

                // Hi·ªÉn th·ªã k·∫øt qu·∫£
                resultBox.style.display = "block";
                const formattedPrice = new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' }).format(result.predicted_price);
                document.getElementById("priceDisplay").innerText = formattedPrice;
                document.getElementById("msgDisplay").innerText = result.message;

            } catch (error) {
                alert("L·ªói k·∫øt n·ªëi! Ki·ªÉm tra xem Server ch·∫°y ch∆∞a?");
            } finally {
                btn.innerText = "üîÆ ƒê·ªäNH GI√Å NGAY";
                btn.disabled = false;
            }
        }
    </script>
</body>
</html>